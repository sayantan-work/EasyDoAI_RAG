DATABASE SCHEMA: Company Attendance Management System
======================================================

OVERVIEW:
This database is designed to manage employee attendance, leave, performance, and company structure. The core of the system revolves around the 'company_employee' table, which links users to companies and their daily activities. All daily check-ins are stored in 'company_attendance_master', which is then used to generate monthly summary reports in 'attendance_report'. Policy tables like 'company_leave' and 'company_holiday' provide the rules for the system.

TABLE OF CONTENTS:
- users
- company
- company_branch
- company_employee
- company_attendance_master
- company_attendance (Legacy)
- attendance_report
- company_leave
- company_employee_leave
- company_holiday
- company_over_time_approval
- company_report_overall_scores
- company_weightages

-----------------------------------
--- TABLE: users
-----------------------------------
Purpose: Master table for all system users, containing personal and login information.

SCHEMA:
  id [BIGINT]
  - Description: Unique identifier for the user.
  unique_id [TEXT]
  - Description: A secondary unique system-generated ID for the user.
  user_name [TEXT]
  - Description: The user's chosen username for the system.
  first_name [TEXT]
  - Description: The user's first name.
  last_name [TEXT]
  - Description: The user's last name.
  contact_number [TEXT]
  - Description: The user's phone number.
  email [TEXT]
  - Description: The user's unique email address, often used for login.
  time_zone [TEXT]
  - Description: The user's local timezone (e.g., 'Asia/Kolkata').
  user_status [TEXT]
  - Description: The current status of the user account (e.g., 'active', 'inactive').
  is_active [BOOLEAN]
  - Description: A flag indicating if the user account is active.

RELATIONSHIPS:
  - PRIMARY KEY: id

-----------------------------------
--- TABLE: company
-----------------------------------
Purpose: Master table for storing core information about each company.

SCHEMA:
  id [BIGINT]
  - Description: Unique identifier for the company.
  user_id [BIGINT]
  - Description: A reference to the user who owns or manages the company.
  name [TEXT]
  - Description: The legal name of the company.
  company_email [TEXT]
  - Description: The official contact email for the company.
  company_phone [TEXT]
  - Description: The official contact phone number for the company.
  time_zone [TEXT]
  - Description: The company's primary timezone.
  status [TEXT]
  - Description: The current status of the company (e.g., 'active', 'suspended').
  total_minutes [INTEGER]
  - Description: The default number of working minutes per day for the company.

RELATIONSHIPS:
  - PRIMARY KEY: id
  - FOREIGN KEY: user_id REFERENCES users(id)

-----------------------------------
--- TABLE: company_branch
-----------------------------------
Purpose: Stores information about each physical branch or office location of a company.

SCHEMA:
  id [BIGINT]
  - Description: Unique identifier for the branch.
  company_id [BIGINT]
  - Description: A reference to the parent company.
  name [TEXT]
  - Description: The name of the branch (e.g., "Head Office").
  address [TEXT]
  - Description: The full address of the branch.
  latitude [NUMERIC]
  - Description: The GPS latitude of the branch.
  longitude [NUMERIC]
  - Description: The GPS longitude of the branch.
  working_day [TEXT]
  - Description: A list of working days for this branch.
  start_time_utc [TIME]
  - Description: The official start time for the branch in UTC.
  end_time_utc [TIME]
  - Description: The official end time for the branch in UTC.
  geofencing [BOOLEAN]
  - Description: A flag indicating if geofencing is enabled for this branch.

RELATIONSHIPS:
  - PRIMARY KEY: id
  - FOREIGN KEY: company_id REFERENCES company(id)

-----------------------------------
--- TABLE: company_employee
-----------------------------------
Purpose: Master table linking a user to a company, making them an employee. This is a central table.

SCHEMA:
  id [BIGINT]
  - Description: Unique identifier for the employee record.
  unique_id [TEXT]
  - Description: A unique system-generated ID for the employee.
  company_id [BIGINT]
  - Description: A reference to the company the employee works for.
  user_id [BIGINT]
  - Description: A reference to the user's master profile in the 'users' table.
  company_branch_id [BIGINT]
  - Description: A reference to the employee's assigned branch.
  employee_name [TEXT]
  - Description: The full name of the employee.
  employee_mobile [TEXT]
  - Description: The employee's contact mobile number.
  employee_email [TEXT]
  - Description: The employee's contact email.
  designation [TEXT]
  - Description: The employee's job title.
  reporting_manager_id [BIGINT]
  - Description: A self-referencing key to another employee who is their manager.
  working_hours [NUMERIC]
  - Description: The number of hours the employee is expected to work per day.
  start_time_utc [TIME]
  - Description: The employee's specific start time in UTC.
  end_time_utc [TIME]
  - Description: The employee's specific end time in UTC.
  is_overtime_allowed [BOOLEAN]
  - Description: A flag indicating if the employee is permitted to work overtime.
  date_of_joining [DATE]
  - Description: The date the employee joined the company.
  status [TEXT]
  - Description: The current employment status (e.g., 'active', 'terminated').

RELATIONSHIPS:
  - PRIMARY KEY: id
  - FOREIGN KEY: company_id REFERENCES company(id)
  - FOREIGN KEY: user_id REFERENCES users(id)
  - FOREIGN KEY: company_branch_id REFERENCES company_branch(id)
  - FOREIGN KEY: reporting_manager_id REFERENCES company_employee(id)

-----------------------------------
--- TABLE: company_attendance_master
-----------------------------------
Purpose: Stores daily check-in/check-out records and attendance status for each employee.

SCHEMA:
  id [BIGINT]
  - Description: Unique identifier for the attendance record.
  company_id [BIGINT]
  - Description: A reference to the company.
  company_branch_id [BIGINT]
  - Description: A reference to the branch.
  company_employee_id [BIGINT]
  - Description: A reference to the employee whose attendance is being recorded.
  user_id [BIGINT]
  - Description: A reference to the user profile.
  local_date [DATE]
  - Description: The specific date of the attendance record.
  check_in_time [TIME]
  - Description: The time the employee punched in.
  check_out_time [TIME]
  - Description: The time the employee punched out.
  total_minutes [INTEGER]
  - Description: Total minutes worked for the day.
  total_over_time_minute [INTEGER]
  - Description: Total overtime minutes for the day.
  is_late [BOOLEAN]
  - Description: A flag indicating if the employee was late.
  is_doing_overtime [BOOLEAN]
  - Description: A flag indicating if the employee worked overtime.
  status [TEXT]
  - Description: The status for the day (e.g., 'present', 'weekoff', 'leave').
  is_half_day [BOOLEAN]
  - Description: A flag indicating if the attendance was for a half-day.
  latitude [NUMERIC]
  - Description: GPS latitude of the check-in.
  longitude [NUMERIC]
  - Description: GPS longitude of the check-in.
  address [TEXT]
  - Description: Address of the check-in location.
  check_in_location_name [TEXT]
  - Description: The name of the check-in location.
  check_out_location_name [TEXT]
  - Description: The name of the check-out location.
  notes [TEXT]
  - Description: Any notes associated with the day's attendance.
  created_at [TIMESTAMP]
  - Description: Timestamp for record creation.
  updated_at [TIMESTAMP]
  - Description: Timestamp for the last update to the record.

RELATIONSHIPS:
  - PRIMARY KEY: id
  - FOREIGN KEY: company_id REFERENCES company(id)
  - FOREIGN KEY: company_branch_id REFERENCES company_branch(id)
  - FOREIGN KEY: company_employee_id REFERENCES company_employee(id)
  - FOREIGN KEY: user_id REFERENCES users(id)

-----------------------------------
--- TABLE: company_attendance (Legacy)
-----------------------------------
Purpose: Stores legacy attendance records with a slightly different structure.

SCHEMA:
  id [BIGINT]
  - Description: Unique identifier for the legacy record.
  company_id [BIGINT]
  - Description: A reference to the company.
  company_branch_id [BIGINT]
  - Description: A reference to the branch.
  user_id [BIGINT]
  - Description: A reference to the user.
  company_employee_id [BIGINT]
  - Description: A reference to the employee.
  check_in_time [TIMESTAMP]
  - Description: The full check-in date and time.
  check_out_time [TIMESTAMP]
  - Description: The full check-out date and time.
  total_over_time_minute [INTEGER]
  - Description: Total overtime minutes.
  is_doing_overtime [BOOLEAN]
  - Description: A flag for overtime.
  is_late [BOOLEAN]
  - Description: A flag for lateness.
  is_half_day [BOOLEAN]
  - Description: A flag for half-day attendance.
  status [TEXT]
  - Description: The status of the attendance.
  total_minutes [INTEGER]
  - Description: Total minutes worked.
  date [DATE]
  - Description: The date of the attendance.

RELATIONSHIPS:
  - PRIMARY KEY: id

-----------------------------------
--- TABLE: attendance_report
-----------------------------------
Purpose: Stores monthly aggregated attendance summaries for each employee. This data is calculated from 'company_attendance_master'.

SCHEMA:
  id [BIGINT]
  - Description: Unique identifier for the report.
  user_id [BIGINT]
  - Description: A reference to the user.
  company_id [BIGINT]
  - Description: A reference to the company.
  company_employee_id [BIGINT]
  - Description: A reference to the employee.
  company_branch_id [BIGINT]
  - Description: A reference to the branch.
  month [INTEGER]
  - Description: The month of the report, often in YYYYMM format.
  month_total_day [INTEGER]
  - Description: The total number of days in the month.
  working_day [INTEGER]
  - Description: Total number of working days in the month for this employee.
  holiday [INTEGER]
  - Description: Total holidays in the month.
  weekoff_day [INTEGER]
  - Description: Total weekend/off-days in the month.
  leave_day [INTEGER]
  - Description: Total days the employee was on leave.
  present_day [INTEGER]
  - Description: Total days the employee was present.
  absent_day [INTEGER]
  - Description: Total days the employee was absent.
  late_day [INTEGER]
  - Description: Total number of times the employee was late.
  half_day [INTEGER]
  - Description: Total number of half-days taken.
  month_avg [NUMERIC]
  - Description: The employee's average score or hours for the month.
  overtime_minutes [INTEGER]
  - Description: Total overtime minutes for the month.
  total_minutes [INTEGER]
  - Description: Total minutes worked for the month.

RELATIONSHIPS:
  - PRIMARY KEY: id
  - FOREIGN KEY: user_id REFERENCES users(id)
  - FOREIGN KEY: company_id REFERENCES company(id)
  - FOREIGN KEY: company_employee_id REFERENCES company_employee(id)
  - FOREIGN KEY: company_branch_id REFERENCES company_branch(id)

-----------------------------------
--- TABLE: company_leave
-----------------------------------
Purpose: Defines the company-wide leave policy for a given year.

SCHEMA:
  id [BIGINT]
  - Description: Unique identifier for the leave policy record.
  company_id [BIGINT]
  - Description: A reference to the company.
  year [INTEGER]
  - Description: The year for which this policy applies.
  sick_leave [INTEGER]
  - Description: Total number of sick leaves allocated per year.
  casual_leave [INTEGER]
  - Description: Total number of casual leaves allocated per year.
  earned_leave [INTEGER]
  - Description: Total number of earned leaves allocated per year.
  is_carry_forward_leave_allowed [BOOLEAN]
  - Description: A flag indicating if unused leaves can be carried forward.

RELATIONSHIPS:
  - PRIMARY KEY: id
  - FOREIGN KEY: company_id REFERENCES company(id)

-----------------------------------
--- TABLE: company_employee_leave
-----------------------------------
Purpose: Tracks the specific leave balances for an individual employee for a given year.

SCHEMA:
  id [BIGINT]
  - Description: Unique identifier for the employee leave record.
  company_employee_id [BIGINT]
  - Description: A reference to the employee.
  year [INTEGER]
  - Description: The year for which this balance applies.
  earned_leave [NUMERIC]
  - Description: The employee's current earned leave balance.
  casual_leave [NUMERIC]
  - Description: The employee's current casual leave balance.
  sick_leave [NUMERIC]
  - Description: The employee's current sick leave balance.

RELATIONSHIPS:
  - PRIMARY KEY: id
  - FOREIGN KEY: company_employee_id REFERENCES company_employee(id)

-----------------------------------
--- TABLE: company_holiday
-----------------------------------
Purpose: Stores the list of official holidays for a company in a specific year.

SCHEMA:
  id [BIGINT]
  - Description: Unique identifier for the holiday.
  company_id [BIGINT]
  - Description: A reference to the company.
  name [TEXT]
  - Description: The name of the holiday (e.g., "New Year").
  date [DATE]
  - Description: The specific date of the holiday.
  year [INTEGER]
  - Description: The year of the holiday.

RELATIONSHIPS:
  - PRIMARY KEY: id
  - FOREIGN KEY: company_id REFERENCES company(id)

-----------------------------------
--- TABLE: company_over_time_approval
-----------------------------------
Purpose: Manages overtime approval requests submitted by employees.

SCHEMA:
  id [BIGINT]
  - Description: Unique identifier for the approval request.
  company_employee_id [BIGINT]
  - Description: A reference to the employee who worked overtime.
  updated_by [BIGINT]
  - Description: A reference to the manager who approved/rejected the request.
  date [DATE]
  - Description: The date the overtime was worked.
  title [TEXT]
  - Description: A short title for the overtime request.
  notes [TEXT]
  - Description: Detailed notes about the overtime work.
  status [TEXT]
  - Description: The current status of the request (e.g., 'pending', 'approved').

RELATIONSHIPS:
  - PRIMARY KEY: id
  - FOREIGN KEY: company_employee_id REFERENCES company_employee(id)
  - FOREIGN KEY: updated_by REFERENCES company_employee(id)

-----------------------------------
--- TABLE: company_report_overall_scores
-----------------------------------
Purpose: Stores monthly aggregated performance scores for employees.

SCHEMA:
  id [BIGINT]
  - Description: Unique identifier for the score record.
  company_employee_id [BIGINT]
  - Description: A reference to the employee being scored.
  month [INTEGER]
  - Description: The month of the score in YYYYMM format.
  overall_score [NUMERIC]
  - Description: The final aggregated score.
  attendance_score [NUMERIC]
  - Description: The score component based on attendance.
  task_performance_score [NUMERIC]
  - Description: The score component based on task performance.

RELATIONSHIPS:
  - PRIMARY KEY: id
  - FOREIGN KEY: company_employee_id REFERENCES company_employee(id)

-----------------------------------
--- TABLE: company_weightages
-----------------------------------
Purpose: Defines the weight of each component in the overall performance score calculation.

SCHEMA:
  id [BIGINT]
  - Description: Unique identifier for the weightage record.
  company_id [BIGINT]
  - Description: A reference to the company.
  attendance [INTEGER]
  - Description: The percentage weight for attendance.
  task_performance [INTEGER]
  - Description: The percentage weight for task performance.
  meeting_performance [INTEGER]
  - Description: The percentage weight for meeting performance.

RELATIONSHIPS:
  - PRIMARY KEY: id
  - FOREIGN KEY: company_id REFERENCES company(id)

--- End of Document ---